---
tags: [Vela Gaming, Common Wallet]
---

![Vela Gaming](../../assets/images/vela_gaming/logo.jpg)

# Common Wallet 共享钱包

## Overview 概述

This document describes the service integration between **Gaming (provider)** and an **operator**. The following chapters describe the general concept of integration as well as descriptions and examples of the API methods used for the service integration.<b>
文档介绍了游戏供应商和对接第三方之间的技术接口细节。以下描述了游戏和第三方的一般概念，以及运用接口的描述和示例。

### General Notes 一般注意事项

- Data Format: JSON (JavaScript Object Notation)
- 数据格式: JSON (JavaScript Object Notation)
<br>
- Wallet Option: Common Wallet (a.k.a. Seamless Wallet)
- 电子钱包选项 : 共享钱包 
<br>
- **Operator** - Referred as the operator
- **第三方** - 被称为运营商或第三方
<br>
- **Provider** - Referred as the game provider
- **游戏供应商** - 被称为游戏供应商
<br>
- **Host ID** - This Host ID is an unique token generated from game provider for each game operator 
- **Host ID** - Host ID是游戏供应商为每个第三方提供的唯一令牌
<br>
- **Points** - Referred as the game points; not player's actual wallet balance.
- **Points** - Points是游戏点数；不是玩家的实际钱包余额.
<br>
- The operator manages the user account database (personal information, balance, wallet operations, etc.)
- 游戏第三方管理用户帐户数据库(个人资料, 余额, 钱包操作等.)
<br>
- The provider only manages the player data necessary to perform game operation.
- 游戏供应商仅管理游戏操作所需和玩家数据
<br>
- All methods support uses **HTTPS GET** verb in the system.
- 全部请求内容必须使用 HTTPS GET 调用
<br>
- Players perform all betting and gaming by using Operator's wallet system. Therefore, **operator** need to develop and integrate VG API .
- 玩家使用VG Game Server的钱包系统执行所有投注和游戏。因此,**第三方**需要连接VG API。



### Getting started 游戏接入规范

To be able to connect to our game server, **operator** needs to provide the following API for us to communicate between game server and operator site. Players perform all betting and gaming by using operator's own wallet system.<b>
为了能够连接到我们的VG游戏服务器。 第三方需要提供以下API给我们在游戏服务器和第三方之间进行链接。玩家使用VG Game Server的钱包系统执行所有投注和游戏。

- [Authenticate 认证 (O)](#authenticate-认证)
- [Bet 下注 (O)](#bet-下注)
- [Result 成绩 (O)](#result-成绩)
- [Refund Bet 退款 (O)](#refund-bet-退款)
- [Bet and Win 下注赢利 (O)](#bet-and-win-下注赢利)
- [Game List 游戏列表](#game-list-游戏列表)
- [Game Launch 游戏启动](#game-launch-游戏启动)
- [User Report 玩家报表](#user-report-玩家报表)

\*\*(O) is referred to API that is required to be develop by operator.
<b> \*\*(O) 是指第三方必须开发的API。

### Game Launch Process 游戏启动流程

- When a player launches the game, it will call the **Operator's Authenticate** API.
- 当玩家启动游戏时，将调用**第三方** Authenticate API.
<br>
- Operator needs to provide us the **Authenticate** API.
- 第三方需要向我们提供 **Authenticate** API。
<br>
- The **Authenticate** API is used by VG Game Server to retrieve players' information from the operator.
- VG 游戏服务器使用 **Authenticate** API 来检索第三方玩家的信息。
<br>
- Authenticate API is called upon launching the game for the logged-in player.
- 已登录玩家启动游戏时会调用Authenticate API。
<br>
![Diagram](../../assets/images/vela_gaming/game_launch_diagram.jpg)

---

## API 游戏程序接口参考

### Authenticate 认证

Authenticate API is called upon launching the game for the logged-in player. **Operator needs to implement this API for user verification**.<b>
已登录玩家启动游戏时会调用Authenticate API。**第三方需要实施此API进行用户验证。**

<!--
type: tab
title: Docs 文件
-->

### Request

| Name 名称    | Type 类型   | Description 介绍                                                                     |
| ------------ | ------ | ------------------------------------------------------------------------------ |
| access_token | string | The access token is generated by operator system for the player’s session. <b>玩家在第三方系统内的访问令牌  |
| game_code    | string | Game code is referred to [Game List](#game-list-游戏列表) API<b>游戏代码可参考[游戏列表](#game-list-游戏列表) API                                                                      |

> ##### Example 例子
>
> <https://{OPERATOR_API_ENDPOINT}/api/user/authenticate?access_token={access_token}&game_code=fish>

### Response 响应

| Name   名称     | Type  类型 | Description   介绍                                                                          |
| ----------- | ------ | --------------------------------------------------------------------------------------- |
| status_code | int    | Response status code<b>响应状态代码                                                                    |
| member_id   | string | Unique ID of the player<b>玩家唯一ID                                                                 |
| balance     | uint64 | Current **Balance** of the player (in cents)<b>玩家点数 (进位两位数，分钱)                                            |
| currency    | string | Currency code is referred to ISO 4217<b>货币代码可参考ISO 4217                                                                          |

#### Status Code 状态代码

| Code 代码 | Description 介绍  |
| ---- | ------------- |
| 0    | Success<b>成功       |
| 1    | Invalid Token<b>访问令牌无效 |

<!--
type: tab
title: Examples 例子
-->

### Sample Success Response 成功响应例子

```json
{
  "status_code": 0,
  "member_id": "demo01",
  "balance": 100000,
  "currency": "MYR"
}
```

### Sample Error Response 错误响应例子

```json
{
  "status_code": 1,
  "message": "Invalid Token"
}
```

<!--
type: tab
title: Try It 尝试
-->

```json http
{
  "method": "get",
  "url": "https://{OPERATOR_API_ENDPOINT}/api/user/authenticate",
  "query": {
    "access_token": "{access_token}",
    "game_code": "fish"
  }
}
```


<!-- type: tab-end -->

---

### Bet 下注

When the game places a bet, it will call  **Operator's API** to deduct player's wallet. **Operator needs to implement this API for betting operation**.<b>
当玩家下注时，游戏会调用**第三方接口来扣除玩家的钱包。**

<!--
type: tab
title: Docs 文件
-->

### Request 请求

| Name   名称      | Type 类型  | Description   介绍                                                                 |
| ------------ | ------ | ------------------------------------------------------------------------------ |
| access_token | string | The access token is generated by operator system for the player's session.<b>玩家在第三方系统内的访问令牌。
 |
| ticket_id    | uint64 | Unique ID of the transaction on the Operator side.<b>第三方交易的唯一ID。                             |
| total_bet    | uint64 | Total betting **POINTS** (in Cents)<b>总下注**点数**(进位两位数，分钱）                                            |
| key          | string | Bet type of the betting trade<b>下注交易的下注类型                                                  |
| game_code    | string | Game code is referred to [Game List](#game-list)<b>游戏代码可参考[游戏列表](#game-list-游戏列表) API                                                        |

> ##### Example 例子
>
> <https://{OPERATOR_API_ENDPOINT}/api/bet?access_token={access_token}&ticket_id={ticket_id}&total_bet={total_bet}&key={key}&game_code={game_code}>

### Response 响应

| Name 名称       | Type 类型  | Description  介绍                                                                          |
| ----------- | ------ | -------------------------------------------------------------------------------------- |
| status_code | int    | Response status code<b>响应状态代码                                                                   |
| balance     | uint64 | Current **POINTS** of the player (in cents)<b>玩家**点数**(进位两位数，分钱)                                            |

#### Status Code 状态代码

| Code 代码 | Description 介绍           |
| ---- | ---------------------- |
| 0    | Success<b>成功                |
| 1    | Invalid Token<b>访问令牌无效          |
| 2    | Invalid Transaction ID<b>交易单号无效 |
| 3    | Insufficient Funds<b>资金不足     |

<!--
type: tab
title: Examples 例子
-->

### Sample Success Response 成功响应例子

```json
{
  "status_code": 0,
  "balance": 100000
}
```

### Sample Error Response 错误响应例子

```json
{
  "status_code": 1,
  "message": "Invalid token"
}
```

<!--
type: tab
title: Try It 尝试
-->

```json http
{
  "method": "get",
  "url": "https://{OPERATOR_API_ENDPOINT}/api/bet",
  "query": {
    "access_token": "{access_token}",
    "ticket_id": "{ticket_id}",
    "total_bet": 10000,
    "key": "{key}",
    "game_code": "{game_code}"
  }
}
```

<!-- type: tab-end -->

### Result

When the game provider has the result return, it will call Result API. This  API will be called despite a winning bet or losing bet. If it’s a losing bet, the total win is return as 0. Otherwise, the total win amount will be returned. **Operator needs to implement this API for each bet result**.

<!--
type: tab
title: Docs
-->

### Request

| Name         | Type   | Description                                                                                                                                                                                                                                                                        |
| ------------ | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| access_token | string | The access token is generated by operator system for the player's session.                                                                                                                                                                                                     |
| ticket_id    | uint64 | Unique ID of the transaction on the Operator side.                                                                                                                                                                                                                                 |
| total_win    | uint64 | Total winning **POINTS** (in Cents)                                                                                                                                                                                                                                                |
| game_code    | string | Game code is referred to [Game List](#game-list) API                                                                                                                                                                                                                                                           |
| total_used   | uint64 | (Optional) _This is an additional parameter that will only present in action games (i.e. Blue Ocean, Safari Hunter, and Bird of Paradise)._ <br> Total **POINTS** used (in Cents) in action games. <br> This field records how much credit a player has used in the action game. |

> ##### Example
>
> <https://{OPERATOR_API_ENDPOINT}/api/result?access_token={access_token}&ticket_id={ticket_id}&total_win={total_win}&game_code={game_code}>

### Response

| Name        | Type   | Description                                                                            |
| ----------- | ------ | -------------------------------------------------------------------------------------- |
| status_code | int    | Response status code                                                                   |
| balance     | uint64 | Current **POINTS** of the player (in cents)                                            |

#### Status Code

| Code | Description            |
| ---- | ---------------------- |
| 0    | Success                |
| 1    | Invalid Token          |
| 2    | Invalid Transaction ID |

<!--
type: tab
title: Examples
-->

### Sample Success Response

```json
{
  "status_code": 0,
  "balance": 100000
}
```

### Sample Error Response

```json
{
  "status_code": 1,
  "message": "Invalid token"
}
```

<!--
type: tab
title: Try It
-->

```json http
{
  "method": "get",
  "url": "https://{OPERATOR_API_ENDPOINT}/api/result",
  "query": {
    "access_token": "{access_token}",
    "ticket_id": "{ticket_id}",
    "total_win": 10000,
    "game_code": "{game_code}"
  }
}
```

<!-- type: tab-end -->

### Refund Bet

This API is called to cancel the latest Bet if system error occurred. **Operator needs to implement this API for refund purpose**.

<!--
type: tab
title: Docs
-->

### Request

| Name         | Type   | Description                                                                    |
| ------------ | ------ | ------------------------------------------------------------------------------ |
| access_token | string | The access token is generated by operator system for the player's session. |
| ticket_id    | uint64 | Unique ID of the transaction on the Operator side.                             |
| game_code    | string | Game code is referred to [Game List](#game-list) API                                                     |

> ##### Example
>
> <https://{OPERATOR_API_ENDPOINT}/api/refund?access_token={access_token}&ticket_id={ticket_id}&game_code={game_code}>

### Response

| Name        | Type   | Description                                                                            |
| ----------- | ------ | -------------------------------------------------------------------------------------- |
| status_code | int    | Response status code                                                                   |
| balance     | uint64 | Current **POINTS** of the player (in cents)                                            |

#### Status Code

| Code | Description            |
| ---- | ---------------------- |
| 0    | Success                |
| 1    | Invalid Token          |
| 2    | Invalid Transaction ID |

<!--
type: tab
title: Examples
-->

### Sample Success Response

```json
{
  "status_code": 0,
  "balance": 100000
}
```

### Sample Error Response

```json
{
  "status_code": 1,
  "message": "Invalid token"
}
```

<!--
type: tab
title: Try It
-->

```json http
{
  "method": "get",
  "url": "https://{OPERATOR_API_ENDPOINT}/api/refund",
  "query": {
    "access_token": "{access_token}",
    "ticket_id": "{ticket_id}",
    "game_code": "{game_code}"
  }
}
```

<!-- type: tab-end -->

### Bet and Win

This API is used for slot games. The game will call this **Operator API** to deduct or deposit their wallet. **_Operator needs to implement this API for slot games purpose_**.

<!--
type: tab
title: Docs
-->

### Request

| Name         | Type   | Description                                                                    |
| ------------ | ------ | ------------------------------------------------------------------------------ |
| access_token | string | The access token is generated by operator system for the player's session. |
| ticket_id    | uint64 | Unique ID of the transaction on the Operator side.                             |
| total_bet    | uint64 | Total betting **POINTS** (in Cents)                                            |
| total_win    | uint64 | Total winning **POINTS** (in Cents)                                            |
| game_code    | string | Game code is referred to [Game List](#game-list) API                                                        |

> ##### Example
>
> <https://{OPERATOR_API_ENDPOINT}/api/betwin?access_token={access_token}&ticket_id={ticket_id}&total_bet={total_bet}&total_win={total_win}&game_code={game_code}>

### Response

| Name        | Type   | Description                                                                            |
| ----------- | ------ | -------------------------------------------------------------------------------------- |
| status_code | int    | Response status code                                                                   |
| balance     | uint64 | Current **POINTS** of the player (in cents)                                            |

#### Status Code

| Code | Description            |
| ---- | ---------------------- |
| 0    | Success                |
| 1    | Invalid Token          |
| 2    | Invalid Transaction ID |
| 3    | Insufficient Funds     |

<!--
type: tab
title: Examples
-->

### Sample Success Response

```json
{
  "status_code": 0,
  "balance": 100000
}
```

### Sample Error Response

```json
{
  "status_code": 1,
  "message": "Invalid token"
}
```

<!--
type: tab
title: Try It
-->

```json http
{
  "method": "get",
  "url": "https://{OPERATOR_API_ENDPOINT}/api/betwin",
  "query": {
    "access_token": "{access_token}",
    "ticket_id": "{ticket_id}",
    "total_bet": "{total_bet}",
    "total_win": "{total_win}",
    "game_code": "{game_code}"
  }
}
```

<!-- type: tab-end -->

## Game List 

This api will return game list to operator.

<!--
type: tab
title: Docs
-->

### Request

| Name    | Type   | Description                                          |
| ------- | ------ | ---------------------------------------------------- |
| host_id | string | Unique ID of Operator System (provided by game provider) |

> ##### Example
>
> <https://{PROVIDER_API_ENDPOINT}/api/user/gamelist?host_id={host_id}>

### Response

| Name        | Type  | Description          |
| ----------- | ----- | -------------------- |
| status_code | int   | Response status code |
| list        | array | A list of game list  |

#### Status Code

| Code | Description                    |
| ---- | ------------------------------ |
| 0    | Success                        |
| 2    | Invalid Host ID                |
| 2001 | Required field cannot be empty |

<!--
type: tab
title: Examples
-->

### Sample Success Response

```json
{
  "data": {
    "status_code": 0,
    "list": [
      {
        "title": {
          "en": "Blue Ocean",
          "cn": "蓝海龙王"
        },
        "game_id": "shoot-01",
        "game_code": "fish",
        "lobby_group": "shooting",
        "url": "https://shoot-01.velachip.com"
      }
    ]
  }
}
```

### Sample Error Response

```json
{
  "error": {
    "status_code": 2,
    "message": "Invalid Host ID",
    "retry": null
  }
}
```

<!--
type: tab
title: Try It
-->

```json http
{
  "method": "get",
  "url": "https://{PROVIDER_API_ENDPOINT}/api/user/gamelist",
  "query": {
    "host_id": "{host_id}"
  }
}
```

<!-- type: tab-end -->

## Game Launch

For launching games, please refer to the URL parameters as below. The game URL is referred to [Game List](#game-list) reponse.

<!--
type: tab
title: Docs
-->

### Request

| Name           | Type   | Description                                                                         |
| -------------- | ------ | ----------------------------------------------------------------------------------- |
| host_id        | string | Unique ID of Operator System (provided by game provider)                                |
| access_token   | string | The access token is generated by operator system for the player's session.      |
| mode           | string | Game mode <br> (singleplayer, multiplayer) <br> \*\*\*only required for action game |
| lang           | string | Language of the game (ch, en) <br> Default language is en                           |
| allow_vertical | int    | Default is 1 <br> 0 - landscape mode <br> 1 - allow vertical mode and landscape mode |

> If host_id and access_token is not provided, it is treated as **Guest** mode.
>
> ##### Example
>
> <https://{GAME_URL}?host_id={host_id}&access_token={access_token}&mode=singleplayer&lang=ch&allow_vertical=1>

<!-- type: tab-end -->

## User Report

This API is called to retrieve the game report from Game Server. **Operator** must maintain the key to keep track log request. For the first time to request log, key = 0. The response return the key value to **operator** for the next log request.

<!--
type: tab
title: Docs
-->

### Request

| Name    | Type   | Description                                          |
| ------- | ------ | ---------------------------------------------------- |
| host_id | string | Unique ID of Operator System (provided by game provider) |
| key     | string | Unique database index number                         |

> If key is empty, it will return data from index zero (0).
>
> ##### Example
>
> <https://{PROVIDER_API_ENDPOINT}/api/report?host_id={host_id}&key={key}>

### Response

| Name        | Type  | Description          |
| ----------- | ----- | -------------------- |
| status_code | int   | Response status code |
| report      | array | A list report        |

#### Status Code

| Code | Description     |
| ---- | --------------- |
| 0    | Success         |
| 2    | Invalid Host ID |

#### Report

| Name          | Type   | Description     |
| ------------- | ------ | --------------- |
| id            | int    | Id              |
| ticket_id     | int    | Ticket Id       |
| game_code     | string | Game code is referred to [Game List](#game-list) API       |
| game_group    | string | Game group      |
| username      | string | Player username |
| bet_stake     | double | Bet stake       |
| commission    | double | Commission      |
| bet_info      | array  | Bet info        |
| result_info   | array  | Result info     |
| payout_amount | double | Payout amount   |
| gain_amount   | double | Gain amount     |
| loss_amount   | double | Loss amount     |
| draw_amount   | double | Draw amount     |
| cancel_amount | double | Cancel amount   |
| reject_amount | double | Reject amount   |
| status        | string | Status          |
| report_date   | date   | Report date     |

<!--
type: tab
title: Examples
-->

### Sample Success Response

```json
{
  "data": {
    "status_code": 0,
    "report": [
      {
        "id": "4",
        "ticket_id": "2192",
        "game_code": "fish",
        "code": "fish",
        "game_group": "action",
        "username": "demo04",
        "bet_stake": 10000,
        "commission": 0,
        "bet_info": {
          "room_type": "room x1"
        },
        "result_info": {
          "total_bullet_cost": 3,
          "total_fish_payout": 0
        },
        "payout_amount": 9997,
        "gain_amount": 0,
        "loss_amount": 3,
        "draw_amount": 0,
        "cancel_amount": 0,
        "reject_amount": 0,
        "data": null,
        "status": "done",
        "remark": null,
        "report_date": "2017-07-31 17:38:10"
      }
    ],
    "key": "13",
    "version_key": "13"
  }
}
```

### Sample Error Response

```json
{
  "error": {
    "status_code": 2,
    "message": "Invalid Host ID"
  }
}
```

<!--
type: tab
title: Try It
-->

```json http
{
  "method": "get",
  "url": "https://{PROVIDER_API_ENDPOINT}/api/report",
  "query": {
    "host_id": "{host_id}",
    "key": "{key}"
  }
}
```

<!-- type: tab-end -->
